{"version":3,"sources":["/home/travis/build/angular/angular/dist/packages-dist/service-worker/bundles/service-worker.umd.js"],"names":["global","factory","exports","module","require","define","amd","ng","serviceWorker","core","Rx","Observable","prototype","this","_angular_core","rxjs_operator_filter","rxjs_operator_take","rxjs_operator_toPromise","rxjs_observable_concat","rxjs_observable_defer","rxjs_observable_fromEvent","rxjs_observable_of","rxjs_observable_throw","rxjs_operator_do","rxjs_operator_map","rxjs_operator_publish","rxjs_operator_switchMap","rxjs_Subject","rxjs_observable_merge","rxjs_observable_never","errorObservable","message","defer","_throw","Error","ngswAppInitializer","injector","script","options","app","get","ApplicationRef","navigator","enabled","onStable","filter","call","isStable","stable","take","toPromise","then","register","scope","ngswCommChannelFactory","opts","NgswCommChannel","undefined","__assign","Object","assign","t","s","i","n","arguments","length","p","hasOwnProperty","ERR_SW_NOT_SUPPORTED","controllerChangeEvents","fromEvent","controllerChanges","map","controller","currentController","of","controllerWithChanges","concat","worker","c","registration","switchMap","getRegistration","rawEvents","rawEventPayload","event","data","eventsUnconnected","events","publish","connect","postMessage","action","payload","sideEffect","_do","sw","postMessageWithStatus","type","nonce","waitForStatus","Promise","all","generateNonce","Math","round","random","eventsOfType","nextEventOfType","statusEventsWithNonce","singleStatusEvent","mapErrorAndValue","status","defineProperty","enumerable","configurable","SwPush","subscriptionChanges","Subject","isEnabled","messages","never","subscription","pushManager","workerDrivenSubscriptions","pm","getSubscription","sub","merge","requestSubscription","_this","reject","pushOptions","userVisibleOnly","key","atob","serverPublicKey","replace","applicationServerKey","Uint8Array","ArrayBuffer","charCodeAt","subscribe","subscribeOnce","next","unsubscribe","success","unsubscribeOnce","decorators","Injectable","ctorParameters","SwUpdate","available","activated","checkForUpdate","statusNonce","activateUpdate","RegistrationOptions","SCRIPT","InjectionToken","ServiceWorkerModule","ngModule","providers","provide","useValue","useFactory","deps","APP_INITIALIZER","Injector","multi","NgModule","args","ɵe","ɵa","ɵb","ɵc","ɵd","value"],"mappings":";;;;;CAKC,SAAUA,OAAQC,SACC,gBAAZC,UAA0C,mBAAXC,QAAyBF,QAAQC,QAASE,QAAQ,iBAAkBA,QAAQ,wBAAyBA,QAAQ,sBAAuBA,QAAQ,2BAA4BA,QAAQ,0BAA2BA,QAAQ,yBAA0BA,QAAQ,6BAA8BA,QAAQ,sBAAuBA,QAAQ,yBAA0BA,QAAQ,oBAAqBA,QAAQ,qBAAsBA,QAAQ,yBAA0BA,QAAQ,2BAA4BA,QAAQ,gBAAiBA,QAAQ,yBAA0BA,QAAQ,0BAC5iB,kBAAXC,SAAyBA,OAAOC,IAAMD,QAAQ,UAAW,gBAAiB,uBAAwB,qBAAsB,0BAA2B,yBAA0B,wBAAyB,4BAA6B,qBAAsB,wBAAyB,mBAAoB,oBAAqB,wBAAyB,0BAA2B,eAAgB,wBAAyB,yBAA0BJ,SACxbA,SAASD,OAAOO,GAAKP,OAAOO,OAAUP,OAAOO,GAAGC,kBAAoBR,OAAOO,GAAGE,KAAKT,OAAOU,GAAGC,WAAWC,UAAUZ,OAAOU,GAAGC,WAAWC,UAAUZ,OAAOU,GAAGC,WAAWC,UAAUZ,OAAOU,GAAGC,WAAWX,OAAOU,GAAGC,WAAWX,OAAOU,GAAGC,WAAWX,OAAOU,GAAGC,WAAWX,OAAOU,GAAGC,WAAWX,OAAOU,GAAGC,WAAWC,UAAUZ,OAAOU,GAAGC,WAAWC,UAAUZ,OAAOU,GAAGC,WAAWC,UAAUZ,OAAOU,GAAGC,WAAWC,UAAUZ,OAAOU,GAAGV,OAAOU,GAAGC,WAAWX,OAAOU,GAAGC,aAC9bE,KAAM,SAAWX,QAAQY,cAAcC,qBAAqBC,mBAAmBC,wBAAwBC,uBAAuBC,sBAAsBC,0BAA0BC,mBAAmBC,sBAAsBC,iBAAiBC,kBAAkBC,sBAAsBC,wBAAwBC,aAAaC,sBAAsBC,uBAAyB,YA+DtW,SAASC,iBAAgBC,SACrB,MAAOZ,uBAAsBa,MAAM,WAAc,MAAOV,uBAAsBW,OAAO,GAAIC,OAAMH,YAiXnG,QAASI,oBAAmBC,SAAUC,OAAQC,SAa1C,MAZmC,YAC/B,GAAqBC,KAAMH,SAASI,IAAI1B,cAAc2B,eACtD,IAAM,iBAAmBC,aAAkC,IAApBJ,QAAQK,QAA/C,CAGA,GAAqBC,UAA6B7B,qBAAqB8B,OAAOC,KAAKP,IAAIQ,SAAU,SAAUC,QAAU,QAASA,SACzGD,SAA6B/B,mBAAmBiC,KAAKH,KAAKF,SAAU,EACrC3B,yBAAwBiC,UAAUJ,KAAKC,UAGhFI,KAAK,WAAc,MAAOT,WAAUlC,cAAc4C,SAASf,QAAUgB,MAAOf,QAAQe,YAQvG,QAASC,wBAAuBC,MAC5B,MAAO,IAAIC,kBAAiC,IAAjBD,KAAKZ,QAAoBD,UAAUlC,kBAAgBiD,IAjblF,GAAIC,UAAWC,OAAOC,QAAU,SAAkBC,GAC9C,IAAK,GAAIC,GAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,IAAK,CACjDD,EAAIG,UAAUF,EACd,KAAK,GAAII,KAAKL,GAAOH,OAAO/C,UAAUwD,eAAetB,KAAKgB,EAAGK,KAAIN,EAAEM,GAAKL,EAAEK,IAE9E,MAAON,IAmBPQ,qBAAuB,gEAyBvBb,gBAAiC,WACjC,QAASA,iBAAgBhD,eAErB,GADAK,KAAKL,cAAgBA,cAChBA,cAGA,CACD,GAAqB8D,wBAA4ClD,0BAA0BmD,UAAU/D,cAAe,oBAC/FgE,kBAAuChD,kBAAkBiD,IAAI3B,KAAKwB,uBAAwB,WAAc,MAAO9D,eAAckE,aAC7HC,kBAAuCxD,sBAAsBa,MAAM,WAAc,MAAOX,oBAAmBuD,GAAGpE,cAAckE,cAC5HG,sBAA2C3D,uBAAuB4D,OAAOH,kBAAmBH,kBACjH3D,MAAKkE,OAA4BhE,qBAAqB8B,OAAOC,KAAK+B,sBAAuB,SAAUG,GAAK,QAASA,IACjHnE,KAAKoE,aAAkCvD,wBAAwBwD,UAAUpC,KAAKjC,KAAKkE,OAAQ,WAAc,MAAOvE,eAAc2E,mBAC9H,IAAqBC,WAAYhE,0BAA0BmD,UAAU/D,cAAe,WAC/D6E,gBAAqC7D,kBAAkBiD,IAAI3B,KAAKsC,UAAW,SAAUE,OAAS,MAAOA,OAAMC,OAC3GC,kBAAuCzE,qBAAqB8B,OAAOC,KAAKuC,gBAAiB,SAAUC,OAAS,QAASA,SAAW,MAAiC,OACjKG,OAA4BhE,sBAAsBiE,QAAQ5C,KAAK0C,kBACpF3E,MAAK4E,OAASA,OACdA,OAAOE,cAdP9E,MAAKkE,OAASlE,KAAK4E,OAAS5E,KAAKoE,aAAenD,gBAAgBuC,sBA6IxE,MAnHAb,iBAAgB5C,UAAUgF,YAM1B,SAAUC,OAAQC,SACd,GAAqBf,QAAS/D,mBAAmBiC,KAAKH,KAAKjC,KAAKkE,OAAQ,GACnDgB,WAAaxE,iBAAiByE,IAAIlD,KAAKiC,OAAQ,SAAUkB,IAC1EA,GAAGL,YAAYlC,UAAWmC,OAAQA,QAAUC,WAEhD,OAA0B7E,yBAAwBiC,UAAUJ,KAAKiD,YAAY5C,KAAK,eAYtFK,gBAAgB5C,UAAUsF,sBAO1B,SAAUC,KAAML,QAASM,OACrB,GAAqBC,eAAgBxF,KAAKwF,cAAcD,OACnCR,YAAc/E,KAAK+E,YAAYO,KAAML,QAC1D,OAAOQ,SAAQC,KAAKF,cAAeT,cAAczC,KAAK,eAS1DK,gBAAgB5C,UAAU4F,cAI1B,WAAc,MAAOC,MAAKC,MAAsB,IAAhBD,KAAKE,WAUrCnD,gBAAgB5C,UAAUgG,aAM1B,SAAUT,MACN,MAA0BpF,sBAAqB8B,OAAOC,KAAKjC,KAAK4E,OAAQ,SAAUH,OAAS,MAAOA,OAAMa,OAASA,QAWrH3C,gBAAgB5C,UAAUiG,gBAM1B,SAAUV,MACN,MAA0BnF,oBAAmBiC,KAAKH,KAAKjC,KAAK+F,aAAaT,MAAO,IAUpF3C,gBAAgB5C,UAAUyF,cAK1B,SAAUD,OACN,GAAqBU,uBAA2C/F,qBAAqB8B,OAAOC,KAAKjC,KAAK+F,aAAa,UAAW,SAAUtB,OAAS,MAAOA,OAAMc,QAAUA,QACnJW,kBAAuC/F,mBAAmBiC,KAAKH,KAAKgE,sBAAuB,GAC3FE,iBAAsCxF,kBAAkBiD,IAAI3B,KAAKiE,kBAAmB,SAAUzB,OAC/G,IAAIA,MAAM2B,OAGV,KAAM,IAAI/E,OAAyBoD,MAAY,QAEnD,OAAOrE,yBAAwBiC,UAAUJ,KAAKkE,mBAElDrD,OAAOuD,eAAe1D,gBAAgB5C,UAAW,aAC7C4B,IAGA,WAAc,QAAS3B,KAAKL,eAC5B2G,YAAY,EACZC,cAAc,IAEX5D,mBAmBP6D,OAAwB,WACxB,QAASA,QAAOpB,IAGZ,GAFApF,KAAKoF,GAAKA,GACVpF,KAAKyG,oBAAsB,GAAI3F,cAAa4F,SACvCtB,GAAGuB,UAGJ,MAFA3G,MAAK4G,SAAW5F,sBAAsB6F,aACtC7G,KAAK8G,aAAe9F,sBAAsB6F,QAG9C7G,MAAK4G,SACDjG,kBAAkBiD,IAAI3B,KAAKjC,KAAKoF,GAAGW,aAAa,QAAS,SAAU7E,SAAW,MAAOA,SAAQwD,OACjG1E,KAAK+G,YAAiCpG,kBAAkBiD,IAAI3B,KAAKjC,KAAKoF,GAAGhB,aAAc,SAAUA,cAAgB,MAAOA,cAAa2C,aACrI,IAAqBC,2BAA+CnG,wBAAwBwD,UAAUpC,KAAKjC,KAAK+G,YAAa,SAAUE,IAAM,MAAOA,IAAGC,kBAAkB5E,KAAK,SAAU6E,KAAO,MAAOA,QACtMnH,MAAK8G,aAAe/F,sBAAsBqG,MAAMJ,0BAA2BhH,KAAKyG,qBAgFpF,MA9EA3D,QAAOuD,eAAeG,OAAOzG,UAAW,aAKpC4B,IAKA,WAAc,MAAO3B,MAAKoF,GAAGuB,WAC7BL,YAAY,EACZC,cAAc,IAMlBC,OAAOzG,UAAUsH,oBAIjB,SAAU5F,SACN,GAAI6F,OAAQtH,IACZ,KAAKA,KAAKoF,GAAGuB,UACT,MAAOlB,SAAQ8B,OAAO,GAAIlG,OAAMmC,sBAKpC,KAAK,GAHgBgE,cAAgBC,iBAAiB,GACjCC,IAAMC,KAAKlG,QAAQmG,gBAAgBC,QAAQ,KAAM,KAAKA,QAAQ,KAAM,MACpEC,qBAAuB,GAAIC,YAAW,GAAIC,aAAYN,IAAIrE,SACrDH,EAAI,EAAGA,EAAIwE,IAAIrE,OAAQH,IAC7C4E,qBAAqB5E,GAAKwE,IAAIO,WAAW/E,EAE7CsE,aAAYM,qBAAuBA,oBACnC,IAAqBI,WAA+BrH,wBAAwBwD,UAAUpC,KAAKjC,KAAK+G,YAAa,SAAUE,IAAM,MAAOA,IAAGiB,UAAUV,eAC5HW,cAAgBhI,mBAAmBiC,KAAKH,KAAKiG,UAAW,EAC7E,OAA0B9H,yBAAwBiC,UAAUJ,KAAKkG,eAAiB7F,KAAK,SAAU6E,KAE7F,MADAG,OAAMb,oBAAoB2B,KAAKjB,KACxBA,OAMfX,OAAOzG,UAAUsI,YAGjB,WACI,GAAIf,OAAQtH,IACZ,KAAKA,KAAKoF,GAAGuB,UACT,MAAOlB,SAAQ8B,OAAO,GAAIlG,OAAMmC,sBAEpC,IAAqB6E,aAAcxH,wBAAwBwD,UAAUpC,KAAKjC,KAAK8G,aAAc,SAAUK,KACnG,GAAY,OAARA,IACA,MAAOA,KAAIkB,cAAc/F,KAAK,SAAUgG,SACpC,GAAIA,QAEA,WADAhB,OAAMb,oBAAoB2B,KAAK,KAI/B,MAAM,IAAI/G,OAAM,wBAKxB,MAAM,IAAIA,OAAM,2CAGHkH,gBAAkBpI,mBAAmBiC,KAAKH,KAAKoG,YAAa,EACjF,OAAyBjI,yBAAwBiC,UAAUJ,KAAKsG,kBAEpE/B,OAAOgC,aACDlD,KAAMrF,cAAcwI,aAG1BjC,OAAOkC,eAAiB,WAAc,QAChCpD,KAAM3C,mBAEL6D,UAoBPmC,SAA0B,WAC1B,QAASA,UAASvD,IAEd,GADApF,KAAKoF,GAAKA,IACLA,GAAGuB,UAGJ,MAFA3G,MAAK4I,UAAY5H,sBAAsB6F,aACvC7G,KAAK6I,UAAY7H,sBAAsB6F,QAG3C7G,MAAK4I,UAAY5I,KAAKoF,GAAGW,aAAa,oBACtC/F,KAAK6I,UAAY7I,KAAKoF,GAAGW,aAAa,oBAiD1C,MA/CAjD,QAAOuD,eAAesC,SAAS5I,UAAW,aAKtC4B,IAKA,WAAc,MAAO3B,MAAKoF,GAAGuB,WAC7BL,YAAY,EACZC,cAAc,IAKlBoC,SAAS5I,UAAU+I,eAGnB,WACI,IAAK9I,KAAKoF,GAAGuB,UACT,MAAOlB,SAAQ8B,OAAO,GAAIlG,OAAMmC,sBAEpC,IAAqBuF,aAAc/I,KAAKoF,GAAGO,eAC3C,OAAO3F,MAAKoF,GAAGC,sBAAsB,qBAAuB0D,YAAaA,aAAeA,cAK5FJ,SAAS5I,UAAUiJ,eAGnB,WACI,IAAKhJ,KAAKoF,GAAGuB,UACT,MAAOlB,SAAQ8B,OAAO,GAAIlG,OAAMmC,sBAEpC,IAAqBuF,aAAc/I,KAAKoF,GAAGO,eAC3C,OAAO3F,MAAKoF,GAAGC,sBAAsB,mBAAqB0D,YAAaA,aAAeA,cAE1FJ,SAASH,aACHlD,KAAMrF,cAAcwI,aAG1BE,SAASD,eAAiB,WAAc,QAClCpD,KAAM3C,mBAELgG,YAiBPM,oBAAqC,WACrC,QAASA,wBAET,MAAOA,wBAEPC,OAAS,GAAIjJ,eAAckJ,eAAe,wBAgC1CC,oBAAqC,WACrC,QAASA,wBAkDT,MAjCAA,qBAAoB7G,SASpB,SAAUf,OAAQkB,MAEd,WADa,KAATA,OAAmBA,UAEnB2G,SAAUD,oBACVE,YACMC,QAASL,OAAQM,SAAUhI,SAC3B+H,QAASN,oBAAqBO,SAAU9G,OACxC6G,QAAS5G,gBAAiB8G,WAAYhH,uBAAwBiH,MAAOT,uBAEnEM,QAAStJ,cAAc0J,gBACvBF,WAAYnI,mBACZoI,MAAOzJ,cAAc2J,SAAUV,OAAQD,qBACvCY,OAAO,MAKvBT,oBAAoBZ,aACdlD,KAAMrF,cAAc6J,SAAUC,OACpBT,WAAY9C,OAAQmC,cAIpCS,oBAAoBV,eAAiB,WAAc,UAC5CU,sBAGX/J,SAAQ+J,oBAAsBA,oBAC9B/J,QAAQmH,OAASA,OACjBnH,QAAQsJ,SAAWA,SACnBtJ,QAAQ2K,GAAKrH,gBACbtD,QAAQ4K,GAAKhB,oBACb5J,QAAQ6K,GAAKhB,OACb7J,QAAQ8K,GAAK7I,mBACbjC,QAAQ+K,GAAK3H,uBAEbK,OAAOuD,eAAehH,QAAS,cAAgBgL,OAAO","file":"/home/travis/build/angular/angular/dist/packages-dist/service-worker/bundles/service-worker.umd.min.js","sourcesContent":["/**\n * @license Angular v5.1.0-rc.0-f841fbe\n * (c) 2010-2017 Google, Inc. https://angular.io/\n * License: MIT\n */\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/core'), require('rxjs/operator/filter'), require('rxjs/operator/take'), require('rxjs/operator/toPromise'), require('rxjs/observable/concat'), require('rxjs/observable/defer'), require('rxjs/observable/fromEvent'), require('rxjs/observable/of'), require('rxjs/observable/throw'), require('rxjs/operator/do'), require('rxjs/operator/map'), require('rxjs/operator/publish'), require('rxjs/operator/switchMap'), require('rxjs/Subject'), require('rxjs/observable/merge'), require('rxjs/observable/never')) :\n\ttypeof define === 'function' && define.amd ? define(['exports', '@angular/core', 'rxjs/operator/filter', 'rxjs/operator/take', 'rxjs/operator/toPromise', 'rxjs/observable/concat', 'rxjs/observable/defer', 'rxjs/observable/fromEvent', 'rxjs/observable/of', 'rxjs/observable/throw', 'rxjs/operator/do', 'rxjs/operator/map', 'rxjs/operator/publish', 'rxjs/operator/switchMap', 'rxjs/Subject', 'rxjs/observable/merge', 'rxjs/observable/never'], factory) :\n\t(factory((global.ng = global.ng || {}, global.ng.serviceWorker = {}),global.ng.core,global.Rx.Observable.prototype,global.Rx.Observable.prototype,global.Rx.Observable.prototype,global.Rx.Observable,global.Rx.Observable,global.Rx.Observable,global.Rx.Observable,global.Rx.Observable,global.Rx.Observable.prototype,global.Rx.Observable.prototype,global.Rx.Observable.prototype,global.Rx.Observable.prototype,global.Rx,global.Rx.Observable,global.Rx.Observable));\n}(this, (function (exports,_angular_core,rxjs_operator_filter,rxjs_operator_take,rxjs_operator_toPromise,rxjs_observable_concat,rxjs_observable_defer,rxjs_observable_fromEvent,rxjs_observable_of,rxjs_observable_throw,rxjs_operator_do,rxjs_operator_map,rxjs_operator_publish,rxjs_operator_switchMap,rxjs_Subject,rxjs_observable_merge,rxjs_observable_never) { 'use strict';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\n\r\n\r\nvar __assign = Object.assign || function __assign(t) {\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n    }\r\n    return t;\r\n};\n\n/**\n * @license Angular v5.1.0-rc.0-f841fbe\n * (c) 2010-2017 Google, Inc. https://angular.io/\n * License: MIT\n */\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nvar ERR_SW_NOT_SUPPORTED = 'Service workers are disabled or not supported by this browser';\n/**\n * @record\n */\n\n/**\n * \\@experimental\n * @record\n */\n\n/**\n * \\@experimental\n * @record\n */\n\n/**\n * @param {?} message\n * @return {?}\n */\nfunction errorObservable(message) {\n    return rxjs_observable_defer.defer(function () { return rxjs_observable_throw._throw(new Error(message)); });\n}\n/**\n * \\@experimental\n */\nvar NgswCommChannel = /** @class */ (function () {\n    function NgswCommChannel(serviceWorker) {\n        this.serviceWorker = serviceWorker;\n        if (!serviceWorker) {\n            this.worker = this.events = this.registration = errorObservable(ERR_SW_NOT_SUPPORTED);\n        }\n        else {\n            var /** @type {?} */ controllerChangeEvents = /** @type {?} */ ((rxjs_observable_fromEvent.fromEvent(serviceWorker, 'controllerchange')));\n            var /** @type {?} */ controllerChanges = /** @type {?} */ ((rxjs_operator_map.map.call(controllerChangeEvents, function () { return serviceWorker.controller; })));\n            var /** @type {?} */ currentController = /** @type {?} */ ((rxjs_observable_defer.defer(function () { return rxjs_observable_of.of(serviceWorker.controller); })));\n            var /** @type {?} */ controllerWithChanges = /** @type {?} */ ((rxjs_observable_concat.concat(currentController, controllerChanges)));\n            this.worker = /** @type {?} */ ((rxjs_operator_filter.filter.call(controllerWithChanges, function (c) { return !!c; })));\n            this.registration = /** @type {?} */ ((rxjs_operator_switchMap.switchMap.call(this.worker, function () { return serviceWorker.getRegistration(); })));\n            var /** @type {?} */ rawEvents = rxjs_observable_fromEvent.fromEvent(serviceWorker, 'message');\n            var /** @type {?} */ rawEventPayload = /** @type {?} */ ((rxjs_operator_map.map.call(rawEvents, function (event) { return event.data; })));\n            var /** @type {?} */ eventsUnconnected = /** @type {?} */ ((rxjs_operator_filter.filter.call(rawEventPayload, function (event) { return !!event && !!(/** @type {?} */ (event))['type']; })));\n            var /** @type {?} */ events = /** @type {?} */ ((rxjs_operator_publish.publish.call(eventsUnconnected)));\n            this.events = events;\n            events.connect();\n        }\n    }\n    /**\n     * @internal\n     */\n    /**\n     * \\@internal\n     * @param {?} action\n     * @param {?} payload\n     * @return {?}\n     */\n    NgswCommChannel.prototype.postMessage = /**\n     * \\@internal\n     * @param {?} action\n     * @param {?} payload\n     * @return {?}\n     */\n    function (action, payload) {\n        var /** @type {?} */ worker = rxjs_operator_take.take.call(this.worker, 1);\n        var /** @type {?} */ sideEffect = rxjs_operator_do._do.call(worker, function (sw) {\n            sw.postMessage(__assign({ action: action }, payload));\n        });\n        return /** @type {?} */ ((rxjs_operator_toPromise.toPromise.call(sideEffect).then(function () { return undefined; })));\n    };\n    /**\n     * @internal\n     */\n    /**\n     * \\@internal\n     * @param {?} type\n     * @param {?} payload\n     * @param {?} nonce\n     * @return {?}\n     */\n    NgswCommChannel.prototype.postMessageWithStatus = /**\n     * \\@internal\n     * @param {?} type\n     * @param {?} payload\n     * @param {?} nonce\n     * @return {?}\n     */\n    function (type, payload, nonce) {\n        var /** @type {?} */ waitForStatus = this.waitForStatus(nonce);\n        var /** @type {?} */ postMessage = this.postMessage(type, payload);\n        return Promise.all([waitForStatus, postMessage]).then(function () { return undefined; });\n    };\n    /**\n     * @internal\n     */\n    /**\n     * \\@internal\n     * @return {?}\n     */\n    NgswCommChannel.prototype.generateNonce = /**\n     * \\@internal\n     * @return {?}\n     */\n    function () { return Math.round(Math.random() * 10000000); };\n    /**\n     * @internal\n     */\n    /**\n     * \\@internal\n     * @template T\n     * @param {?} type\n     * @return {?}\n     */\n    NgswCommChannel.prototype.eventsOfType = /**\n     * \\@internal\n     * @template T\n     * @param {?} type\n     * @return {?}\n     */\n    function (type) {\n        return /** @type {?} */ ((rxjs_operator_filter.filter.call(this.events, function (event) { return event.type === type; })));\n    };\n    /**\n     * @internal\n     */\n    /**\n     * \\@internal\n     * @template T\n     * @param {?} type\n     * @return {?}\n     */\n    NgswCommChannel.prototype.nextEventOfType = /**\n     * \\@internal\n     * @template T\n     * @param {?} type\n     * @return {?}\n     */\n    function (type) {\n        return /** @type {?} */ ((rxjs_operator_take.take.call(this.eventsOfType(type), 1)));\n    };\n    /**\n     * @internal\n     */\n    /**\n     * \\@internal\n     * @param {?} nonce\n     * @return {?}\n     */\n    NgswCommChannel.prototype.waitForStatus = /**\n     * \\@internal\n     * @param {?} nonce\n     * @return {?}\n     */\n    function (nonce) {\n        var /** @type {?} */ statusEventsWithNonce = /** @type {?} */ ((rxjs_operator_filter.filter.call(this.eventsOfType('STATUS'), function (event) { return event.nonce === nonce; })));\n        var /** @type {?} */ singleStatusEvent = /** @type {?} */ ((rxjs_operator_take.take.call(statusEventsWithNonce, 1)));\n        var /** @type {?} */ mapErrorAndValue = /** @type {?} */ ((rxjs_operator_map.map.call(singleStatusEvent, function (event) {\n            if (event.status) {\n                return undefined;\n            }\n            throw new Error(/** @type {?} */ ((event.error)));\n        })));\n        return rxjs_operator_toPromise.toPromise.call(mapErrorAndValue);\n    };\n    Object.defineProperty(NgswCommChannel.prototype, \"isEnabled\", {\n        get: /**\n         * @return {?}\n         */\n        function () { return !!this.serviceWorker; },\n        enumerable: true,\n        configurable: true\n    });\n    return NgswCommChannel;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n/**\n * Subscribe and listen to push notifications from the Service Worker.\n *\n * \\@experimental\n */\nvar SwPush = /** @class */ (function () {\n    function SwPush(sw) {\n        this.sw = sw;\n        this.subscriptionChanges = new rxjs_Subject.Subject();\n        if (!sw.isEnabled) {\n            this.messages = rxjs_observable_never.never();\n            this.subscription = rxjs_observable_never.never();\n            return;\n        }\n        this.messages =\n            rxjs_operator_map.map.call(this.sw.eventsOfType('PUSH'), function (message) { return message.data; });\n        this.pushManager = /** @type {?} */ ((rxjs_operator_map.map.call(this.sw.registration, function (registration) { return registration.pushManager; })));\n        var /** @type {?} */ workerDrivenSubscriptions = /** @type {?} */ ((rxjs_operator_switchMap.switchMap.call(this.pushManager, function (pm) { return pm.getSubscription().then(function (sub) { return sub; }); })));\n        this.subscription = rxjs_observable_merge.merge(workerDrivenSubscriptions, this.subscriptionChanges);\n    }\n    Object.defineProperty(SwPush.prototype, \"isEnabled\", {\n        /**\n         * Returns true if the Service Worker is enabled (supported by the browser and enabled via\n         * ServiceWorkerModule).\n         */\n        get: /**\n         * Returns true if the Service Worker is enabled (supported by the browser and enabled via\n         * ServiceWorkerModule).\n         * @return {?}\n         */\n        function () { return this.sw.isEnabled; },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @param {?} options\n     * @return {?}\n     */\n    SwPush.prototype.requestSubscription = /**\n     * @param {?} options\n     * @return {?}\n     */\n    function (options) {\n        var _this = this;\n        if (!this.sw.isEnabled) {\n            return Promise.reject(new Error(ERR_SW_NOT_SUPPORTED));\n        }\n        var /** @type {?} */ pushOptions = { userVisibleOnly: true };\n        var /** @type {?} */ key = atob(options.serverPublicKey.replace(/_/g, '/').replace(/-/g, '+'));\n        var /** @type {?} */ applicationServerKey = new Uint8Array(new ArrayBuffer(key.length));\n        for (var /** @type {?} */ i = 0; i < key.length; i++) {\n            applicationServerKey[i] = key.charCodeAt(i);\n        }\n        pushOptions.applicationServerKey = applicationServerKey;\n        var /** @type {?} */ subscribe = /** @type {?} */ ((rxjs_operator_switchMap.switchMap.call(this.pushManager, function (pm) { return pm.subscribe(pushOptions); })));\n        var /** @type {?} */ subscribeOnce = rxjs_operator_take.take.call(subscribe, 1);\n        return (/** @type {?} */ (rxjs_operator_toPromise.toPromise.call(subscribeOnce))).then(function (sub) {\n            _this.subscriptionChanges.next(sub);\n            return sub;\n        });\n    };\n    /**\n     * @return {?}\n     */\n    SwPush.prototype.unsubscribe = /**\n     * @return {?}\n     */\n    function () {\n        var _this = this;\n        if (!this.sw.isEnabled) {\n            return Promise.reject(new Error(ERR_SW_NOT_SUPPORTED));\n        }\n        var /** @type {?} */ unsubscribe = rxjs_operator_switchMap.switchMap.call(this.subscription, function (sub) {\n            if (sub !== null) {\n                return sub.unsubscribe().then(function (success) {\n                    if (success) {\n                        _this.subscriptionChanges.next(null);\n                        return undefined;\n                    }\n                    else {\n                        throw new Error('Unsubscribe failed!');\n                    }\n                });\n            }\n            else {\n                throw new Error('Not subscribed to push notifications.');\n            }\n        });\n        var /** @type {?} */ unsubscribeOnce = rxjs_operator_take.take.call(unsubscribe, 1);\n        return /** @type {?} */ (rxjs_operator_toPromise.toPromise.call(unsubscribeOnce));\n    };\n    SwPush.decorators = [\n        { type: _angular_core.Injectable },\n    ];\n    /** @nocollapse */\n    SwPush.ctorParameters = function () { return [\n        { type: NgswCommChannel, },\n    ]; };\n    return SwPush;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n/**\n * Subscribe to update notifications from the Service Worker, trigger update\n * checks, and forcibly activate updates.\n *\n * \\@experimental\n */\nvar SwUpdate = /** @class */ (function () {\n    function SwUpdate(sw) {\n        this.sw = sw;\n        if (!sw.isEnabled) {\n            this.available = rxjs_observable_never.never();\n            this.activated = rxjs_observable_never.never();\n            return;\n        }\n        this.available = this.sw.eventsOfType('UPDATE_AVAILABLE');\n        this.activated = this.sw.eventsOfType('UPDATE_ACTIVATED');\n    }\n    Object.defineProperty(SwUpdate.prototype, \"isEnabled\", {\n        /**\n         * Returns true if the Service Worker is enabled (supported by the browser and enabled via\n         * ServiceWorkerModule).\n         */\n        get: /**\n         * Returns true if the Service Worker is enabled (supported by the browser and enabled via\n         * ServiceWorkerModule).\n         * @return {?}\n         */\n        function () { return this.sw.isEnabled; },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @return {?}\n     */\n    SwUpdate.prototype.checkForUpdate = /**\n     * @return {?}\n     */\n    function () {\n        if (!this.sw.isEnabled) {\n            return Promise.reject(new Error(ERR_SW_NOT_SUPPORTED));\n        }\n        var /** @type {?} */ statusNonce = this.sw.generateNonce();\n        return this.sw.postMessageWithStatus('CHECK_FOR_UPDATES', { statusNonce: statusNonce }, statusNonce);\n    };\n    /**\n     * @return {?}\n     */\n    SwUpdate.prototype.activateUpdate = /**\n     * @return {?}\n     */\n    function () {\n        if (!this.sw.isEnabled) {\n            return Promise.reject(new Error(ERR_SW_NOT_SUPPORTED));\n        }\n        var /** @type {?} */ statusNonce = this.sw.generateNonce();\n        return this.sw.postMessageWithStatus('ACTIVATE_UPDATE', { statusNonce: statusNonce }, statusNonce);\n    };\n    SwUpdate.decorators = [\n        { type: _angular_core.Injectable },\n    ];\n    /** @nocollapse */\n    SwUpdate.ctorParameters = function () { return [\n        { type: NgswCommChannel, },\n    ]; };\n    return SwUpdate;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n/**\n * @abstract\n */\nvar RegistrationOptions = /** @class */ (function () {\n    function RegistrationOptions() {\n    }\n    return RegistrationOptions;\n}());\nvar SCRIPT = new _angular_core.InjectionToken('NGSW_REGISTER_SCRIPT');\n/**\n * @param {?} injector\n * @param {?} script\n * @param {?} options\n * @return {?}\n */\nfunction ngswAppInitializer(injector, script, options) {\n    var /** @type {?} */ initializer = function () {\n        var /** @type {?} */ app = injector.get(_angular_core.ApplicationRef);\n        if (!('serviceWorker' in navigator) || options.enabled === false) {\n            return;\n        }\n        var /** @type {?} */ onStable = /** @type {?} */ (rxjs_operator_filter.filter.call(app.isStable, function (stable) { return !!stable; }));\n        var /** @type {?} */ isStable = /** @type {?} */ (rxjs_operator_take.take.call(onStable, 1));\n        var /** @type {?} */ whenStable = /** @type {?} */ (rxjs_operator_toPromise.toPromise.call(isStable));\n        // Don't return the Promise, as that will block the application until the SW is registered, and\n        // cause a crash if the SW registration fails.\n        whenStable.then(function () { return navigator.serviceWorker.register(script, { scope: options.scope }); });\n    };\n    return initializer;\n}\n/**\n * @param {?} opts\n * @return {?}\n */\nfunction ngswCommChannelFactory(opts) {\n    return new NgswCommChannel(opts.enabled !== false ? navigator.serviceWorker : undefined);\n}\n/**\n * \\@experimental\n */\nvar ServiceWorkerModule = /** @class */ (function () {\n    function ServiceWorkerModule() {\n    }\n    /**\n     * Register the given Angular Service Worker script.\n     *\n     * If `enabled` is set to `false` in the given options, the module will behave as if service\n     * workers are not supported by the browser, and the service worker will not be registered.\n     */\n    /**\n     * Register the given Angular Service Worker script.\n     *\n     * If `enabled` is set to `false` in the given options, the module will behave as if service\n     * workers are not supported by the browser, and the service worker will not be registered.\n     * @param {?} script\n     * @param {?=} opts\n     * @return {?}\n     */\n    ServiceWorkerModule.register = /**\n     * Register the given Angular Service Worker script.\n     *\n     * If `enabled` is set to `false` in the given options, the module will behave as if service\n     * workers are not supported by the browser, and the service worker will not be registered.\n     * @param {?} script\n     * @param {?=} opts\n     * @return {?}\n     */\n    function (script, opts) {\n        if (opts === void 0) { opts = {}; }\n        return {\n            ngModule: ServiceWorkerModule,\n            providers: [\n                { provide: SCRIPT, useValue: script },\n                { provide: RegistrationOptions, useValue: opts },\n                { provide: NgswCommChannel, useFactory: ngswCommChannelFactory, deps: [RegistrationOptions] },\n                {\n                    provide: _angular_core.APP_INITIALIZER,\n                    useFactory: ngswAppInitializer,\n                    deps: [_angular_core.Injector, SCRIPT, RegistrationOptions],\n                    multi: true,\n                },\n            ],\n        };\n    };\n    ServiceWorkerModule.decorators = [\n        { type: _angular_core.NgModule, args: [{\n                    providers: [SwPush, SwUpdate],\n                },] },\n    ];\n    /** @nocollapse */\n    ServiceWorkerModule.ctorParameters = function () { return []; };\n    return ServiceWorkerModule;\n}());\n\nexports.ServiceWorkerModule = ServiceWorkerModule;\nexports.SwPush = SwPush;\nexports.SwUpdate = SwUpdate;\nexports.ɵe = NgswCommChannel;\nexports.ɵa = RegistrationOptions;\nexports.ɵb = SCRIPT;\nexports.ɵc = ngswAppInitializer;\nexports.ɵd = ngswCommChannelFactory;\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=service-worker.umd.js.map\n"]}